graph TB
    subgraph Frontend["Frontend · Next.js + Tailwind + shadcn/ui"]
        ChatUI["Chat Interface"]
        AgentStream["Agent Activity Stream"]
        SourceCards["Source Cards & Citations"]
        IntPanel["Integration Status Panel"]
    end

    subgraph Backend["Backend · FastAPI + Python"]
        API["API Gateway"]
        SessionMgr["Session Manager"]

        subgraph AgentLayer["Agent Layer · Claude Agent SDK"]
            Orchestrator["Orchestrator Agent · Opus 4.6"]

            subgraph Subagents["Subagents"]
                Research["Research Agent · Sonnet 4.5"]
                Backlog["Backlog Agent · Sonnet 4.5"]
                Prioritization["Prioritization Agent · Opus 4.6"]
                DocWriter["Doc Agent · Opus 4.6"]
            end
        end

        subgraph MCPLayer["MCP Integration Layer"]
            SlackMCP["Slack MCP"]
            LinearMCP["Linear MCP"]
            NotionMCP["Notion MCP"]
            WebMCP["Web Search MCP"]
        end

        subgraph Persistence["Persistence Layer"]
            Redis["Redis · Session state + cache"]
            SQLite["SQLite · History + configs"]
            Memory["File Memory · Product knowledge"]
        end
    end

    subgraph External["External Services"]
        SlackAPI["Slack API"]
        LinearAPI["Linear API"]
        NotionAPI["Notion API"]
        BraveAPI["Brave/Tavily API"]
        ClaudeAPI["Anthropic API · Opus 4.6 + Sonnet 4.5"]
    end

    ChatUI -->|SSE| API
    AgentStream -->|SSE| API
    API --> SessionMgr
    SessionMgr --> Orchestrator
    Orchestrator --> Research
    Orchestrator --> Backlog
    Orchestrator --> Prioritization
    Orchestrator --> DocWriter

    Research --> SlackMCP
    Research --> WebMCP
    Backlog --> LinearMCP
    DocWriter --> NotionMCP

    SlackMCP --> SlackAPI
    LinearMCP --> LinearAPI
    NotionMCP --> NotionAPI
    WebMCP --> BraveAPI

    Orchestrator --> ClaudeAPI
    Research --> ClaudeAPI
    Backlog --> ClaudeAPI

    SessionMgr --> Redis
    SessionMgr --> SQLite
    Orchestrator --> Memory

    style Orchestrator fill:#7c3aed,color:#fff,stroke:#5b21b6
    style Research fill:#0ea5e9,color:#fff,stroke:#0284c7
    style Backlog fill:#0ea5e9,color:#fff,stroke:#0284c7
    style Prioritization fill:#7c3aed,color:#fff,stroke:#5b21b6
    style DocWriter fill:#7c3aed,color:#fff,stroke:#5b21b6
    style ClaudeAPI fill:#d97706,color:#fff,stroke:#b45309
